---
page_title: Telemetry - Terraform Cloud Agents - Terraform Cloud and Terraform Enterprise
---

# Telemetry

Terraform Cloud Agents emit telemetry data using the [OpenTelemetry](https://opentelemetry.io/) protocol.

## Configuration

To configure your agent to emit telemetry data, you must include the `-otlp-address` flag or `TFC_AGENT_OTLP_ADDRESS` environment variable. This should be set to the host:port address of an [OpenTelemetry collector](https://opentelemetry.io/docs/concepts/data-collection/). This address should be a GRPC server running an OLTP collector.

Optionally, you can pass the `-otlp-cert-file` or `TFC_AGENT_OTLP_CERT_FILE`. The agent will use a certificate at the path supplied to encrypt the client connection to the OpenTelemetry collector. When omitted, client connections are not secured.

## Tracing

In addition to metrics, the agent emits tracing spans that can be consumed by various distributed tracing tools. Information about supported tools can be found on the [OpenTelemetry Registry](https://opentelemetry.io/registry/). A span is a single unit of work performed by the agent.

Spans conform to the following rules:

* Each span has a unique name in plain English, explaining what it represents.
* Span attributes will be made up of sections, separated by periods. Sections will contain only alphanumeric characters and dashes. For example: `tfc.run.terraform-version`.
* Span attributes in the `tfc` namespace will have information relevant to the entire operation.
* Span attributes in the `debug` namespace will have information relevant to the current span's scope.

## Metrics

The Terraform Cloud Agent emits numerous metrics describing the agent's
performance. The metrics documented on this page are considered stable and will
not change in any significant way between stable releases of the same major
version.

### Metric naming conventions

An example of the metric names that the agent will emit is
`tfc-agent.terraform.plan-json.generate.bytes`. Breaking down those sections:

* `tfc-agent`: Metric names will be namespaced with tfc-agent to distinguish
  them from other metrics your system may be emitting.
* `terraform`: Metric names may have a prefix with a component name, when a
  component is applicable.
* `plan-json`: This shows that the metric in question is about the step of the
  agent process where JSON representations of the Terraform plan and Terraform
  provider schema are generated and uploaded.
* `generate`: Specifically, it is about the generation of the JSON artifacts.
* `bytes`: When a metric requires a unit in order to be understood, an un-
  abbreviated unit will be the last component of the metric name.

In addition, agent metrics will follow some conventions around unit types:

* All timing metrics (other than runtime metrics) will be measured in milliseconds.
* All data size metrics will be measured in bytes.

While all of the metric names emitted by the tfc-agent use hyphens, some systems
may automatically convert these to underscores.

### Core metrics

The following metrics are generated by the Terraform Cloud Agent core program,
and are related to generic operations performed regularly by all agents. All
metrics in this section are prefixed by `tfc-agent.`.

| Meric name                   | Type  | Description                                                                          |
| ---------------------------- | ----- | ------------------------------------------------------------------------------------ |
| `status.busy`                | Gauge | Number of agents in `busy` status.                                                   |
| `status.idle`                | Gauge | Number of agents in `idle` status.                                                   |
| `register.milliseconds`      | Timer | Time in milliseconds to register the agent with Terraform Cloud.                     |
| `fetch-job.milliseconds`     | Timer | Time in milliseconds to complete a job dequeue request.                              |
| `update-status.milliseconds` | Timer | Time in milliseconds to send a status update over from the agent to Terraform Cloud. |

### Runtime metrics

The Terraform Cloud Agent produces a number of metrics which are generated by
the application runtime, and are primarily useful in debugging the tfc-agent.
These metrics are emitted periodically throughout the entire agent process
lifecycle. It is important to note that these metrics do not represent a
complete picture of resource utilization by the agent. The agent may fork child
processes (such as the Terraform binary or other programs) which maintain their
own distinct runtimes and consume resources independently of the agent. To
monitor resource utilization comprehensively, consider monitoring VM or
container metrics. All metrics in this section are prefixed by
`tfc-agent.runtime.`.

| Meric name                      | Type  | Description                                                            |
| ------------------------------- | ----- | ---------------------------------------------------------------------- |
| `go.mem.heap-alloc.bytes`       | Gauge | Amount of memory in bytes allocated to heap objects by the Go runtime. |
| `go.mem.heap-idle.bytes`        | Gauge | Amount of memory in bytes allocated to the heap which are unused.      |
| `go.mem.heap-inuse.bytes`       | Gauge | Amount of memory in bytes allocated to the heap which are in use.      |
| `go.mem.heap-sys.bytes`         | Gauge | Amount of memory in bytes obtained from the OS for the heap.           |
| `go.mem.heap-released.bytes`    | Gauge | Amount of memory in bytes returned to the OS during GC.                |
| `go.mem.heap-objects.count`     | Gauge | Number of allocated heap objects.                                      |
| `go.mem.lookups.count`          | Gauge | Number of pointer lookups.                                             |
| `go.mem.malloc.count`           | Gauge | Cumulative count of heap objects allocated.                            |
| `go.mem.free.count`             | Gauge | Cumulative count of heap objects freed.                                |
| `go.gc.count`                   | Gauge | Number of completed GC cycles.                                         |
| `go.gc.pause-total.nanoseconds` | Timer | Cumulative time in nanoseconds spent in stop-the-world pauses.         |
| `uptime.milliseconds`           | Timer | Cumulative time in milliseconds since the agent started.               |

### Terraform component metrics

The following metrics are emitted by the `terraform` component, which is
responsible for handling Terraform operations like plans and applies. All
metrics in this section are prefixed by `tfc-agent.terraform.`.

| Meric name                                     | Type  | Description                                                                         |
| ---------------------------------------------- | ----- | ----------------------------------------------------------------------------------- |
| `handle-signal.milliseconds`                   | Timer | Time in milliseconds spent handling an incoming signal from Terraform Cloud.        |
| `execute.milliseconds`                         | Timer | Time in milliseconds spent handling a Terraform operation.                          |
| `output-stream.upload-chunk.bytes`             | Gauge | Size in bytes of a chunk of Terraform output uploaded.                              |
| `output-stream.upload-chunk.milliseconds`      | Timer | Time in milliseconds spent uploading a single chunk of Terraform output.            |
| `output-stream.upload-full.bytes`              | Gauge | Size in bytes of a full Terraform log uploaded.                                     |
| `output-stream.upload-full.milliseconds`       | Timer | Time in milliseconds spent uploading the full Terraform log.                        |
| `output-stream.close.milliseconds`             | Timer | Time in milliseconds spent finalizing a Terraform output stream.                    |
| `persist-filesystem.milliseconds`              | Timer | Time in milliseconds spent packing and uploading a filesystem image.                |
| `persist-filesystem.pack.bytes`                | Gauge | Size in bytes of a packed up filesystem image.                                      |
| `persist-filesystem.pack.milliseconds`         | Timer | Time in milliseconds spent packing the contents of a filesystem.                    |
| `persist-filesystem.upload.milliseconds`       | Timer | Time in milliseconds spent uploading a packed up filesystem image.                  |
| `plan-json.generate.bytes`                     | Gauge | Size in bytes of a generated JSON-formatted plan.                                   |
| `plan-json.generate.milliseconds`              | Timer | Time in milliseconds spent generating a JSON plan.                                  |
| `plan-json.upload.milliseconds`                | Timer | Time in milliseconds spent uploading a JSON plan.                                   |
| `provider-schemas-json.generate.bytes`         | Gauge | Size in bytes of a generated JSON-formatted provider schemas file.                  |
| `provider-schemas-json.generate.milliseconds`  | Timer | Time in milliseconds spent generating the provider schemas document.                |
| `provider-schemas-json.upload.milliseconds`    | Timer | Time in milliseconds spent uploading a provider schemas document.                   |
| `restore-filesystem.download.milliseconds`     | Timer | Time in milliseconds spent downloading and unpacking a filesystem image.            |
| `restore-filesystem.download.bytes`            | Gauge | Size in bytes of a downloaded filesystem image.                                     |
| `restore-filesystem.download.milliseconds`     | Timer | Time in milliseconds spent downloading a filesystem image.                          |
| `restore-filesystem.unpack.milliseconds`       | Timer | Time in milliseconds spent unpacking the contents of a filesystem image.            |
| `run-meta.additions`                           | Gauge | Number of resources added or proposed to be added in a Terraform operation.         |
| `run-meta.changes`                             | Gauge | Number of resources changed or proposed to change in a Terraform operation.         |
| `run-meta.destructions`                        | Gauge | Number of resources destroyed or proposed to be destroyed in a Terraform operation. |
| `setup-backend.milliseconds`                   | Timer | Time in milliseconds spent configuring Terraform CLI to for Terraform Cloud.        |
| `setup-terraform-binary.milliseconds`          | Timer | Time spent downloading and unpacking a Terraform OSS release.                       |
| `setup-terraform-binary.download.bytes`        | Gauge | Size in bytes of a downloaded Terraform OSS version.                                |
| `setup-terraform-binary.download.milliseconds` | Timer | Time in milliseconds spent downloading a Terraform OSS release.                     |
| `setup-terraform-binary.unpack.bytes`          | Gauge | Size in bytes of an unpacked Terraform OSS release.                                 |
| `setup-terraform-binary.unpack.milliseconds`   | Timer | Time in milliseconds spent unpacking a Terraform OSS release.                       |
| `setup-terraform-config.milliseconds`          | Timer | Time in milliseconds spent downloading and unpacking a Terraform configuration.     |
| `setup-terraform-config.download.bytes`        | Gauge | Size in bytes of a downloaded Terraform configuration.                              |
| `setup-terraform-config.download.milliseconds` | Timer | Time in milliseconds spent downloading a Terraform configuration.                   |
| `setup-terraform-config.unpack.milliseconds`   | Timer | Time in milliseconds spent unpacking a downloaded Terraform configuration.          |
| `setup-terraform-config.verify.milliseconds`   | Timer | Time in milliseconds spent verifying a Terraform configuration.                     |
| `setup-terraform-variables.milliseconds`       | Timer | Time in milliseconds spent configuring Terraform variables provided by TFC.         |
| `setup-terraform-variables.write_file.bytes`   | Gauge | Size in bytes of a tfvars file, generated by TFC-provided input variables.          |
| `terraform-apply.milliseconds`                 | Timer | Time in milliseconds spent running `terraform apply`.                               |
| `terraform-plan.milliseconds`                  | Timer | Time in milliseconds spent running `terraform plan`.                                |
| `terraform-version.milliseconds`               | Timer | Time in milliseconds spent running `terraform version`.                             |

### Policy component metrics

The following metrics are emitted bythe `policy` component, which is responsible
for handling OPA policy enforement operations. All metrics in this section
are prefixed by `tfc-agent.policy.`.

| Meric name                                     | Type  | Description                                                              |
| ---------------------------------------------- | ----- | ------------------------------------------------------------------------ |
| `execute.milliseconds`                         | Timer | Time in milliseconds spent handling a policy operation.                  |
| `policy-set.download.bytes`                    | Gauge | Size in bytes of a downloaded policy set.                                |
| `policy-set.download.milliseconds`             | Timer | Time in milliseconds spent downloading a policy set.                     |
| `policy-set.unpack.milliseconds`               | Timer | Time in milliseconds spent unpacking a policy set.                       |
| `generate-opa-input-file.milliseconds`         | Timer | Time in milliseconds spent generating the OPA input file.                |
| `parse-opa-config.milliseconds`                | Timer | Time in milliseconds spent parsing the OPA configuration.                |
| `plan-json-download.milliseconds`              | Timer | Time in milliseconds spent downloading the Terraform JSON plan document. |
| `plan-json-download.bytes`                     | Gauge | Size in bytes of a downloaded Terraform JSON plan document.              |
| `run-opa-eval.milliseconds`                    | Timer | Time in milliseconds spent evaluating OPA policies.                      |
| `setup-opa-binary.milliseconds`                | Timer | Time in milliseconds spent downloading the OPA binary.                   |
| `setup-policies.milliseconds`                  | Timer | Time in milliseconds spent setting up individually managed policies.     |
| `setup-policy-engines.milliseconds`            | Timer | Time in milliseconds spent setting up policy runtimes.                   |
| `setup-subjects.milliseconds`                  | Timer | Time in milliseconds spent setting up subjects for policy enforcement.   |
